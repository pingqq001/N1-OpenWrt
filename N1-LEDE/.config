# ======================
# 核心系统配置
# ======================
CONFIG_TARGET_amlogic=y
CONFIG_TARGET_amlogic_mesongx=y
CONFIG_TARGET_amlogic_mesongx_DEVICE_phicomm_n1=y
CONFIG_TARGET_ARCH_PACKAGES="aarch64_cortex-a53"
CONFIG_CPU_TYPE="cortex-a53"
CONFIG_LINUX_5_15=y

# 使用SquashFS+LZMA压缩方案
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=256
CONFIG_TARGET_SQUASHFS_COMPRESSOR=lzma
CONFIG_TARGET_UBIFS_FREE_SPACE_FIXUP=y

# ======================
# 关键空间优化配置
# ======================
CONFIG_KERNEL_KALLSYMS=n
CONFIG_KERNEL_DEBUG_FS=n
CONFIG_KERNEL_DEBUG_KERNEL=n
CONFIG_DEVEL=n
CONFIG_STRIP_KERNEL_EXPORTS=y
CONFIG_USE_MKLIBS=n

# ======================
# 网络基础配置
# ======================
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb-net=y
CONFIG_PACKAGE_kmod-ipt-offload=y

# IPv6精简配置
CONFIG_PACKAGE_ipv6helper=y
CONFIG_PACKAGE_ip6tables=y
CONFIG_PACKAGE_ip6tables-extra=n
CONFIG_PACKAGE_6in4=n

# ======================
# 必要软件包 (最小化集合)
# ======================
# 核心工具
CONFIG_BUSYBOX_CONFIG_FEATURE_USE_INITTAB=y
CONFIG_PACKAGE_opkg=y
CONFIG_PACKAGE_iptables=y
CONFIG_PACKAGE_tar=y
CONFIG_PACKAGE_fdisk=y
CONFIG_PACKAGE_blkid=y
CONFIG_PACKAGE_e2fsprogs=y

# 网络工具
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget=y
CONFIG_PACKAGE_ip-full=y

# ======================
# LUCI核心组件
# ======================
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-theme-argon=y

# 精简版iStore支持
CONFIG_PACKAGE_luci-app-store=y
CONFIG_PACKAGE_luci-lib-ipkg=n

# ======================
# 数据库配置 (嵌入式版本)
# ======================
CONFIG_PACKAGE_libsqlite3=y
CONFIG_PACKAGE_mariadb-server-embedded=y
CONFIG_PACKAGE_mariadb-client=y
CONFIG_PACKAGE_libmariadb=y

# ======================
# 关键修复配置
# ======================
# 修复libgpg-error编译问题
CONFIG_PACKAGE_libgpg-error=y
CONFIG_GPG_ERROR_HOST="linux"
CONFIG_GPG_ERROR_BUILD_TOOLS=y

# 禁用可能引发冲突的包
CONFIG_PACKAGE_libopenssl=n
CONFIG_PACKAGE_libustream-openssl=n
CONFIG_PACKAGE_libustream-wolfssl=y

# ======================
# 硬件支持配置
# ======================
# WiFi驱动
CONFIG_PACKAGE_kmod-brcmfmac=y
CONFIG_BRCMFMAC_SDIO=y
CONFIG_PACKAGE_kmod-cfg80211=y
CONFIG_PACKAGE_wpad-basic=y

# USB存储
CONFIG_PACKAGE_kmod-usb-storage=y
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-vfat=y

# ======================
# 编译系统优化
# ======================
CONFIG_CCACHE=y
CONFIG_BUILD_LOG=y
CONFIG_SRC_TREE_OVERRIDE=y
