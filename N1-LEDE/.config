# 硬件平台配置（完美保留）
CONFIG_TARGET_amlogic=y
CONFIG_TARGET_amlogic_mesongx=y
CONFIG_TARGET_amlogic_mesongx_DEVICE_phicomm_n1=y
CONFIG_TARGET_ARCH_PACKAGES="aarch64_cortex-a53"
CONFIG_CPU_TYPE="cortex-a53-crypto"
CONFIG_DEFAULT_TARGET_OPTIMIZATION="-Os -pipe -mcpu=cortex-a53+crypto -mtune=cortex-a53 -fno-caller-saves"  # 新增编译优化
CONFIG_LINUX_5_15=y
CONFIG_KERNEL_KALLSYMS=n
CONFIG_KERNEL_DEBUG_FS=n
CONFIG_KERNEL_DEBUG_INFO=n                 # 新增：禁用调试信息
CONFIG_STRIP_KERNEL_EXPORTS=y
CONFIG_TARGET_OPTIMIZATION="-Os -pipe -mcpu=cortex-a53+crypto -fno-plt"  # 新增链接优化
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=64       # 从128改为64以获得更好压缩率
CONFIG_TARGET_SQUASHFS_COMPRESSOR=lzma
CONFIG_SQUASHFS_XZ=y                       # 新增：启用XZ压缩支持

# 减少编译输出物 - 使用SquashFS节省空间
CONFIG_TARGET_ROOTFS_TARGZ=n
CONFIG_TARGET_ROOTFS_INITRAMFS=n
CONFIG_TARGET_ROOTFS_CPIOGZ=n
CONFIG_TARGET_ROOTFS_EXT4FS=n
CONFIG_TARGET_ROOTFS_SQUASHFS=y  # 切换到更节省空间的SquashFS

# 加快编译速度
CONFIG_DEVEL=n  # 关闭开发模式节省空间
CONFIG_CCACHE=y

# usb设备支持
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb-hid=y
CONFIG_PACKAGE_kmod-usb-net=y

# Ipv6 支持 - 精简IPv6相关包
CONFIG_PACKAGE_6in4=n
CONFIG_PACKAGE_ipv6helper=y
CONFIG_PACKAGE_ip6tables=y
CONFIG_PACKAGE_ip6tables-extra=n
CONFIG_PACKAGE_ip6tables-mod-nat=n

# luci插件 - 大幅精简
CONFIG_PACKAGE_luci-app-amlogic=y
CONFIG_PACKAGE_luci-app-passwall=y
CONFIG_PACKAGE_luci-app-samba4=y
CONFIG_PACKAGE_luci-app-ttyd=y
CONFIG_PACKAGE_luci-app-store=y  # iStore应用商店
CONFIG_PACKAGE_luci-app-alist=y
CONFIG_PACKAGE_luci-app-mosdns=y
CONFIG_PACKAGE_luci-app-wol=y

# 移除以下插件节省空间
CONFIG_PACKAGE_luci-app-dockerman=n
CONFIG_PACKAGE_luci-app-uhttpd=n
CONFIG_PACKAGE_luci-app-frpc=n
CONFIG_PACKAGE_luci-app-socat=n
CONFIG_PACKAGE_luci-app-cifs-mount=n
CONFIG_PACKAGE_luci-app-acme=n
CONFIG_PACKAGE_luci-app-rclone=n

# theme主题 - 只保留一个主题
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-app-argon-config=y
CONFIG_PACKAGE_luci-theme-design=n
CONFIG_PACKAGE_luci-app-design-config=n
CONFIG_PACKAGE_luci-theme-netgear=n

# vpn插件 - 精简
CONFIG_PACKAGE_luci-app-openvpn-server=n
CONFIG_PACKAGE_luci-app-zerotier=y

#加速插件
CONFIG_PACKAGE_luci-app-turboacc=y
CONFIG_PACKAGE_luci-app-turboacc_INCLUDE_PDNSD=n
CONFIG_PACKAGE_pdnsd-alt=n

# 精简lean默认选中的插件
CONFIG_PACKAGE_luci-app-accesscontrol=n
CONFIG_PACKAGE_luci-app-upnp=n
CONFIG_PACKAGE_luci-app-vsftpd=n
CONFIG_PACKAGE_luci-app-nlbwmon=n
CONFIG_PACKAGE_luci-app-wrtbwmon=n
CONFIG_PACKAGE_luci-app-ssr-plus=n
CONFIG_PACKAGE_luci-app-arpbind=n
CONFIG_PACKAGE_luci-app-filetransfer=n

# 自带ddns插件
CONFIG_PACKAGE_luci-app-ddns=n
CONFIG_PACKAGE_ddns-scripts=n
CONFIG_PACKAGE_ddns-scripts-services=n
CONFIG_PACKAGE_ddns-scripts_aliyun=n
CONFIG_PACKAGE_ddns-scripts_dnspod=n

# other packages - 大幅精简
CONFIG_PACKAGE_fstrim=y
CONFIG_PACKAGE_zoneinfo-asia=y
CONFIG_PACKAGE_openssh-sftp-server=y
CONFIG_PACKAGE_nano-plus=y
CONFIG_PACKAGE_htop=n
CONFIG_PACKAGE_iperf3=n
CONFIG_PACKAGE_snmpd=n
CONFIG_PACKAGE_vim-fuller=n
CONFIG_PACKAGE_zsh=n

# Basic Dependence - 精简依赖
CONFIG_PACKAGE_perl=y
CONFIG_PACKAGE_perl-http-date=y
CONFIG_PACKAGE_perlbase-file=y
CONFIG_PACKAGE_perlbase-getopt=y
CONFIG_PACKAGE_perlbase-time=y
CONFIG_PACKAGE_perlbase-unicode=n
CONFIG_PACKAGE_perlbase-utf8=n

CONFIG_PACKAGE_blkid=y
CONFIG_PACKAGE_fdisk=y
CONFIG_PACKAGE_lsblk=n
CONFIG_PACKAGE_parted=n
CONFIG_PACKAGE_attr=n
CONFIG_PACKAGE_btrfs-progs=n
CONFIG_PACKAGE_chattr=n
CONFIG_PACKAGE_dosfstools=y
CONFIG_PACKAGE_e2fsprogs=y
CONFIG_PACKAGE_lsattr=n
CONFIG_PACKAGE_bsdtar=n
CONFIG_PACKAGE_pigz=n
CONFIG_PACKAGE_bash=y
CONFIG_PACKAGE_gawk=n
CONFIG_PACKAGE_getopt=n
CONFIG_PACKAGE_losetup=n
CONFIG_PACKAGE_tar=y
CONFIG_PACKAGE_uuidgen=n
CONFIG_PACKAGE_acpid=n
CONFIG_PACKAGE_ntfs3-mount=n
CONFIG_PACKAGE_coreutils=y
CONFIG_PACKAGE_coreutils-base64=n
CONFIG_PACKAGE_coreutils-nohup=n
CONFIG_PACKAGE_jq=n
CONFIG_PACKAGE_pv=n

# 添加MariaDB数据库 (精简版)
CONFIG_PACKAGE_mariadb-server-embedded=y  # 使用嵌入式版本节省空间
CONFIG_PACKAGE_mariadb-client=y
CONFIG_PACKAGE_mariadb-server-extra=n
CONFIG_PACKAGE_libmariadb=y

# add wifi
CONFIG_PACKAGE_kmod-brcmfmac=y
CONFIG_BRCMFMAC_SDIO=y
CONFIG_PACKAGE_kmod-brcmutil=y
CONFIG_PACKAGE_kmod-cfg80211=y
CONFIG_PACKAGE_kmod-mac80211=y
CONFIG_PACKAGE_hostapd-common=y
CONFIG_PACKAGE_wpa-cli=y
CONFIG_PACKAGE_wpad-basic=y
CONFIG_PACKAGE_iw=n

# 添加额外的空间优化
CONFIG_KERNEL_KALLSYMS=n
CONFIG_KERNEL_DEBUG_FS=n
CONFIG_KERNEL_DEBUG_KERNEL=n
CONFIG_PACKAGE_luci-lib-ipkg=n
